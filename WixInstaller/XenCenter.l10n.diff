--- XenCenter.wxs	2013-07-01 10:39:54.447126800 +0100
+++ XenCenter.l10n.wxs	2013-07-01 10:39:51.998882000 +0100
@@ -32,13 +32,12 @@
  SUCH DAMAGE. 
 -->
 
-<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi"
-     xmlns:netfx="http://schemas.microsoft.com/wix/NetFxExtension">
+<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
     <?define ProductVersion="1.0.0" ?>
     <?define UpgradeCode="{EA0EF50F-5CC6-452B-B09F-3F5EC564899D}"?>
     <?define ProductCode="{65AE1345-A520-456D-8A19-2F52D43D3A09}"?>
     <Product Id="$(var.ProductCode)" Name="Citrix XenCenter" Language="$(env.WixLangId)" Version="$(var.ProductVersion)" Manufacturer="Citrix Systems, Inc." UpgradeCode="$(var.UpgradeCode)">
-        <Package Description="Citrix XenCenter" Comments="none." InstallerVersion="200" Compressed="yes" />
+        <Package Languages="1033,1041,2052,1028" Description="Citrix XenCenter" Comments="none." InstallerVersion="200" Compressed="yes" />
         <Media Id="1" Cabinet="XenCenter.cab" EmbedCab="yes" />
         <Directory Id="TARGETDIR" Name="SourceDir">
             <Directory Id="ProgramFilesFolder">
@@ -88,64 +87,64 @@
                             <File Id="XslicIcon" Source="..\XenAdmin\Images\file_license.ico" />
                             <File Id="XkbIcon" Source="..\XenAdmin\Images\file_backup.ico" />
                             <File Id="XsupdateIcon" Source="..\XenAdmin\Images\file_updates.ico" />
-							<!-- Define XVA extension -->
-							<ProgId Id="XenCenter.xva" Description="XVA File" Icon="XvaIcon">
+                            <!-- Define XVA extension -->
+							<ProgId Id="XenCenter.xva" Description="!(loc.XVA_File)" Icon="XvaIcon">
                                 <Extension Id="xva" ContentType="application/xva">
-                                    <Verb Id="open" Command="Open" TargetFile="XenCenterEXE" Argument="import &quot;%1&quot;" />
+                                    <Verb Id="open" Command="!(loc.Open)" TargetFile="XenCenterEXE" Argument="import &quot;%1&quot;" />
                                 </Extension>
                             </ProgId>
-							<!-- Define OVF extension -->
-							<ProgId Id="XenCenter.ovf" Description="OVF File" Icon="XvaIcon">
+                            <!-- Define OVF extension -->
+							<ProgId Id="XenCenter.ovf" Description="!(loc.OVF_File)" Icon="XvaIcon">
                                 <Extension Id="ovf" ContentType="application/ovf">
                                     <Verb Id="open" Command="Open" TargetFile="XenCenterEXE" Argument="import &quot;%1&quot;" />
                                 </Extension>
                             </ProgId>
-							<!-- Define OVA extension -->
-							<ProgId Id="XenCenter.ova" Description="OVA File" Icon="XvaIcon">
+                            <!-- Define OVA extension -->
+							<ProgId Id="XenCenter.ova" Description="!(loc.OVA_File)" Icon="XvaIcon">
                                 <Extension Id="ova" ContentType="application/ova">
                                     <Verb Id="open" Command="Open" TargetFile="XenCenterEXE" Argument="import &quot;%1&quot;" />
                                 </Extension>
                             </ProgId>
-							<!-- Define VHD extension -->
-							<ProgId Id="XenCenter.vhd" Description="VHD File" Icon="XvaIcon">
+                            <!-- Define VHD extension -->
+							<ProgId Id="XenCenter.vhd" Description="!(loc.VHD_File)" Icon="XvaIcon">
                                 <Extension Id="vhd" ContentType="application/vhd">
                                     <Verb Id="open" Command="Open" TargetFile="XenCenterEXE" Argument="import &quot;%1&quot;" />
                                 </Extension>
                             </ProgId>
-							<!-- Define VMDK extension -->
-							<ProgId Id="XenCenter.vmdk" Description="VMDK File" Icon="XvaIcon">
+                            <!-- Define VMDK extension -->
+							<ProgId Id="XenCenter.vmdk" Description="!(loc.VMDK_File)" Icon="XvaIcon">
                                 <Extension Id="vmdk" ContentType="application/vmdk">
                                     <Verb Id="open" Command="Open" TargetFile="XenCenterEXE" Argument="import &quot;%1&quot;" />
                                 </Extension>
                             </ProgId>
-							<!-- Define XSLIC extension -->
-							<ProgId Id="XenCenter.xslic" Description="XenServer License File" Icon="XslicIcon">
+                            <!-- Define XSLIC extension -->
+							<ProgId Id="XenCenter.xslic" Description="!(loc.XenServer_License_File)" Icon="XslicIcon">
                                 <Extension Id="xslic" ContentType="application/xslic">
-                                    <Verb Id="open" Command="Open" TargetFile="XenCenterEXE" Argument="license &quot;%1&quot;" />
+                                    <Verb Id="open" Command="!(loc.Open)" TargetFile="XenCenterEXE" Argument="license &quot;%1&quot;" />
                                 </Extension>
                             </ProgId>
-							<!-- Define XBK extension -->
-							<ProgId Id="XenCenter.xbk" Description="XenServer Backup File" Icon="XkbIcon">
+                            <!-- Define XBK extension -->
+							<ProgId Id="XenCenter.xbk" Description="!(loc.XenServer_Backup_File)" Icon="XkbIcon">
                                 <Extension Id="xbk" ContentType="application/xbk">
-                                    <Verb Id="open" Command="Open" TargetFile="XenCenterEXE" Argument="restore &quot;%1&quot;" />
+                                    <Verb Id="open" Command="!(loc.Open)" TargetFile="XenCenterEXE" Argument="restore &quot;%1&quot;" />
                                 </Extension>
                             </ProgId>
                             <!-- Define XSUPDATE extension -->
-							<ProgId Id="XenCenter.xsupdate" Description="XenServer Update File" Icon="XsupdateIcon">
+							<ProgId Id="XenCenter.xsupdate" Description="!(loc.XenServer_Update_File)" Icon="XsupdateIcon">
                                 <Extension Id="xsupdate" ContentType="application/xsupdate">
-                                    <Verb Id="open" Command="Open" TargetFile="XenCenterEXE" Argument="update &quot;%1&quot;" />
+                                    <Verb Id="open" Command="!(loc.Open)" TargetFile="XenCenterEXE" Argument="update &quot;%1&quot;" />
                                 </Extension>
                             </ProgId>
                             <!-- Define XSOEM extension -->
-							<ProgId Id="XenCenter.xsoem" Description="XenServer OEM Update File" Icon="XsupdateIcon">
+							<ProgId Id="XenCenter.xsoem" Description="!(loc.XenServer_OEM_Update_File)" Icon="XsupdateIcon">
                                 <Extension Id="xsoem" ContentType="application/xsoem">
-                                    <Verb Id="open" Command="Open" TargetFile="XenCenterEXE" Argument="update &quot;%1&quot;" />
+                                    <Verb Id="open" Command="!(loc.Open)" TargetFile="XenCenterEXE" Argument="update &quot;%1&quot;" />
                                 </Extension>
                             </ProgId>
                             <!-- Define XENSEARCH extension -->
-                            <ProgId Id="XenCenter.xensearch" Description="XenCenter Saved Search" Icon="XenCenterIcon">
+                            <ProgId Id="XenCenter.xensearch" Description="!(loc.XenCenter_Saved_Search)" Icon="XenCenterIcon">
                                 <Extension Id="xensearch" ContentType="application/xensearch">
-                                    <Verb Id="open" Command="Open" TargetFile="XenCenterEXE" Argument="xensearch &quot;%1&quot;" />
+                                    <Verb Id="open" Command="!(loc.Open)" TargetFile="XenCenterEXE" Argument="xensearch &quot;%1&quot;" />
                                 </Extension>
                             </ProgId>
                         </Component>
@@ -164,6 +163,30 @@
                             <Component Id="HelpFiles" Guid="EA8D4F56-A94A-467c-9E6B-F3DC26F95B1E">
                                 <File Id="XenCenterCHM" Source="..\XenAdmin\bin\Release\Help\XenCenter.chm" />
                                 <File Id="WLBCHM" Source="..\XenAdmin\bin\Release\Help\WLB.chm" />
+                                <File Id="XenCenterJaCHM" Source="..\XenAdmin\bin\Release\Help\XenCenter.ja.chm" />
+                                <File Id="WLBJaCHM" Source="..\XenAdmin\bin\Release\Help\WLB.ja.chm" />
+                                <File Id="XenCenterScCHM" Source="..\XenAdmin\bin\Release\Help\XenCenter.zh-CN.chm" />
+                                <File Id="WLBScCHM" Source="..\XenAdmin\bin\Release\Help\WLB.zh-CN.chm" />
+                            </Component>
+                        </Directory>
+                        <Directory Id="ja" Name="ja">
+                            <Component Id="JaResources" Guid="D3ADD803-AF0B-4787-AC29-C6387FFF403B">
+                                <File Id="JaResourcesDLL" Source="..\XenAdmin\bin\Release\ja\XenCenterMain.resources.dll" />
+                                <File Id="JaXenModResourcesDLL" Source="..\XenAdmin\bin\Release\ja\XenModel.resources.dll" />
+                                <File Id="JaMicRepVwrCmnResDLL" Source="..\XenAdmin\ReportViewer\Microsoft.ReportViewer.Common.resources.dll" />
+                                <File Id="JaMicRepVwrPrcObjResDLL" Source="..\XenAdmin\ReportViewer\Microsoft.ReportViewer.WinForms.resources.dll" />
+                                <File Id="JaXOResourcesDLL" Source="..\XenOvfApi\bin\Release\ja\XenOvf.resources.dll" />
+                                <File Id="JaXOTResourcesDLL" Source="..\XenOvfTransport\bin\Release\ja\XenOvfTransport.resources.dll" />
+                            </Component>
+                        </Directory>
+                        <Directory Id="sc" Name="zh-CN">
+                            <Component Id="ScResources" Guid="381e9319-f0c4-4c69-a1c2-0a2fc725bd19">
+                                <File Id="ScResourcesDLL" Source="..\XenAdmin\bin\Release\zh-CN\XenCenterMain.resources.dll" />
+                                <File Id="ScXenModResourcesDLL" Source="..\XenAdmin\bin\Release\zh-CN\XenModel.resources.dll" />
+                                <File Id="ScMicRepVwrCmnResDLL" Source="..\XenAdmin\ReportViewer\Microsoft.ReportViewer.Common.resources.dll" />
+                                <File Id="ScMicRepVwrPrcObjResDLL" Source="..\XenAdmin\ReportViewer\Microsoft.ReportViewer.WinForms.resources.dll" />
+                                <File Id="ScXOResourcesDLL" Source="..\XenOvfApi\bin\Release\zh-CN\XenOvf.resources.dll" />
+                                <File Id="ScXOTResourcesDLL" Source="..\XenOvfTransport\bin\Release\zh-CN\XenOvfTransport.resources.dll" />
                             </Component>
                         </Directory>
                         <Directory Id="EXTERNALTOOLS" ShortName="External" Name="External Tools">
@@ -213,6 +236,8 @@
         <Feature Id="MainProgram" Title="Citrix XenCenter" Description="The complete package" Display="expand" Level="1" ConfigurableDirectory="INSTALLDIR" AllowAdvertise="no" InstallDefault="local" Absent="disallow">
             <ComponentRef Id="MainExecutable" />
             <ComponentRef Id="HelpFiles" />
+            <ComponentRef Id="JaResources" />
+            <ComponentRef Id="ScResources" />
             <ComponentRef Id="ReportViewer" />
             <ComponentRef Id="TestResources" />
             <ComponentRef Id="SchemasFilesComponent" />
@@ -227,7 +252,7 @@
         <Property Id="ARPPRODUCTICON" Value="XenCenterICO" />
         <MajorUpgrade AllowDowngrades="no" AllowSameVersionUpgrades="yes" DowngradeErrorMessage="!(loc.ErrorNewerProduct)" Schedule="afterInstallInitialize"/>
         <PropertyRef Id="NETFRAMEWORK35" />
-        <Condition Message=".NET Framework 3.5 is required for this installation."><![CDATA[Installed OR NETFRAMEWORK35]]></Condition>
+        <Condition Message="!(loc.Required_For_Installation)"><![CDATA[Installed OR NETFRAMEWORK35]]</Condition>
         <InstallExecuteSequence>
             <AppSearch Sequence="50" />
             <FindRelatedProducts Before="LaunchConditions" />
